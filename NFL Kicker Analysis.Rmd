---
title: "NFL Kicker Analysis"
author: "Josh Garzaniti"
date: "2025-06-21"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load in packages
```{r}
library(ggplot2)
library(ggdark)
library(caret)
library(tidyverse)
library(tidyr)
library(stringr)
library(xgboost)
library(randomForest)
library(ggrepel)
library(nflreadr)
library(nflplotR)
library(nflfastR)
```

##Load in Data via NFLFastR
```{r}
pbp = nflfastR::load_pbp(2000:2024)
```
##Cleaning Steps
Ok now that we've loaded in our data, the first and most obvious thing we want to do is filter it down to only kicking play (field goal attempts and extra point attempts/PAT's)
```{r}
pbp = pbp%>%
  filter(play_type %in% c("extra_point", "field_goal"))

head(pbp, 10)
```

Since 2000, there have been 56,676 observations of plays in the nfl which either fit the description of a field goal or extra point attempt. Let's save this real quick so we don't have to load in all of the pbp data again.

##Save Kicking data subset.
```{r}
write.csv(pbp, "G:/My Drive/Personal Projects/NFL Kicking Analysis.csv", row.names = FALSE)
```

Alternatively, if you're just starting here, you can load in this data and skip the previous steps:
```{r}
pbp = read.csv("G:/My Drive/Personal Projects/NFL Kicking Analysis.csv")
```

Either way pbp should be the subset we are working off of. 

##Continue Data Cleaning and feature selection
Let's continue cleaning by scrubbing some of the existing features we know we probably won't use such as play id, game id etc...

```{r}
pbp = pbp%>%
  select(-game_id,
         -play_id,
         -old_game_id,
         -down,
         -time,
         -yards_gained,
         -shotgun,
         -no_huddle,
         -qb_kneel,
         -qb_dropback,
         -qb_spike,
         -qb_scramble,
         -pass_length,
         -pass_location,
         -air_yards,
         -yards_after_catch,
         -run_location,
         -run_gap,
         -two_point_conv_result,
         -timeout,
         -timeout_team,
         -td_team,
         -td_player_name,
         -td_player_id,
         -posteam_timeouts_remaining,
         -defteam_timeouts_remaining,
         -posteam_score,
         -defteam_score,
         -score_differential,
         -posteam_score_post,
         -defteam_score_post,
         -score_differential_post,
         -two_point_conversion_prob,
         -total_home_rush_epa,
         -total_away_rush_epa,
         -total_home_pass_epa,
         -total_away_pass_epa,
         -air_epa,
         -yac_epa,
         -comp_air_epa,
         -comp_yac_epa,
         -total_home_comp_air_epa,
         -total_away_comp_air_epa,
         -total_home_comp_yac_epa,
         -total_away_comp_yac_epa,
         -total_home_raw_air_epa,
         -total_away_raw_air_epa,
         -total_home_raw_yac_epa,
         -total_away_raw_yac_epa,
         -vegas_wpa,
         -vegas_home_wpa,
         -vegas_wp,
         -vegas_home_wp,
         -home_wp_post,
         -away_wp_post,
         -total_home_rush_wpa,
         -total_away_rush_wpa,
         -total_home_pass_wpa,
         -total_away_pass_wpa,
         -air_wpa,
         -yac_wpa,
         -comp_air_wpa,
         -comp_yac_wpa,
         -total_home_comp_air_wpa,
         -total_away_comp_air_wpa,
         -total_home_comp_yac_wpa,
         -total_away_comp_yac_wpa,
         -total_home_raw_air_wpa,
         -total_away_raw_air_wpa,
         -total_home_raw_yac_wpa,
         -total_away_raw_yac_wpa,
         -punt_blocked,
         -first_down_rush,
         -first_down_pass,
         -third_down_converted,
         -first_down_penalty,
         -third_down_failed,
         -fourth_down_converted,
         -fourth_down_failed,
         -incomplete_pass,
         -touchback,
         -interception,
         -punt_inside_twenty,
         -punt_in_endzone,
         -punt_out_of_bounds,
         -punt_downed,
         -punt_fair_catch,
         -kickoff_inside_twenty,
         -kickoff_in_endzone,
         -kickoff_out_of_bounds,
         -kickoff_downed,
         -kickoff_fair_catch,
         -fumble_forced,
         -fumble_not_forced,
         -fumble_out_of_bounds,
         -solo_tackle,
         -safety,
         -tackled_for_loss,
         -fumble_lost,
         -own_kickoff_recovery,
         -own_kickoff_recovery_td,
         -qb_hit,
         -rush_attempt,
         -pass_attempt,
         -sack,
         -touchdown,
         -pass_touchdown,
         -rush_touchdown,
         -return_touchdown,
         -two_point_attempt,
         -kickoff_attempt,
         -punt_attempt,
         -fumble,
         -complete_pass,
         -assist_tackle,
         -lateral_reception,
         -lateral_rush,
         -lateral_return,
         -lateral_recovery,
         -passer_player_id,
         -passer_player_name,
         -passing_yards,
         -receiver_player_id,
         -receiver_player_name,
         -receiving_yards,
         -rusher_player_id,
         -rusher_player_name,
         -rushing_yards,
         -lateral_receiver_player_id,
         -lateral_receiver_player_name,
         -lateral_receiving_yards,
         -lateral_rusher_player_id,
         -lateral_rusher_player_name,
         -lateral_rushing_yards,
         -lateral_sack_player_id,
         -lateral_sack_player_name,
         -interception_player_id,
         -interception_player_name,
         -lateral_interception_player_id,
         -lateral_interception_player_name,
         -punt_returner_player_id,
         -punt_returner_player_name,
         -lateral_punt_returner_player_id,
         -lateral_punt_returner_player_name,
         -kickoff_returner_player_name,
         -kickoff_returner_player_id,
         -lateral_kickoff_returner_player_id,
         -lateral_kickoff_returner_player_name,
         -punter_player_id,
         -punter_player_name,
         -own_kickoff_recovery_player_id,
         -own_kickoff_recovery_player_name,
         -blocked_player_id,
         -blocked_player_name,
         -tackle_for_loss_1_player_id,
         -tackle_for_loss_1_player_name,
         -tackle_for_loss_2_player_id,
         -tackle_for_loss_2_player_name,
         -qb_hit_1_player_id,
         -qb_hit_1_player_name,
         -qb_hit_2_player_id,
         -qb_hit_2_player_name,
         -forced_fumble_player_1_team,
         -forced_fumble_player_1_player_id,
         -forced_fumble_player_1_player_name,
         -forced_fumble_player_2_team,
         -forced_fumble_player_2_player_id,
         -forced_fumble_player_2_player_name,
         -solo_tackle_1_team,
         -solo_tackle_2_team,
         -solo_tackle_1_player_id,
         -solo_tackle_2_player_id,
         -solo_tackle_1_player_name,
         -solo_tackle_2_player_name,
         -assist_tackle_1_team,
         -assist_tackle_1_player_id,
         -assist_tackle_1_player_name,
         -assist_tackle_2_team,
         -assist_tackle_2_player_id,
         -assist_tackle_2_player_name,
         -assist_tackle_3_team,
         -assist_tackle_3_player_id,
         -assist_tackle_3_player_name,
         -assist_tackle_4_team,
         -assist_tackle_4_player_id,
         -assist_tackle_4_player_name,
         -tackle_with_assist,
         -tackle_with_assist_1_player_id,
         -tackle_for_loss_1_player_name,
         -tackle_for_loss_2_player_id,
         -tackle_for_loss_2_player_name,
         -tackle_with_assist_1_team,
         -tackle_with_assist_2_team,
         -pass_defense_1_player_id,
         -pass_defense_1_player_name,
         -pass_defense_2_player_id,
         -pass_defense_2_player_name,
         -fumbled_1_team,
         -fumbled_1_player_id,
         -fumbled_1_player_name,
         -fumbled_2_team,
         -fumbled_2_player_id,
         -fumbled_2_player_name,
         -fumble_recovery_1_team,
         -fumble_recovery_1_player_id,
         -fumble_recovery_1_player_name,
         -fumble_recovery_2_team,
         -fumble_recovery_2_player_id,
         -fumble_recovery_2_player_name,
         -sack_player_id,
         -sack_player_name,
         -half_sack_1_player_id,
         -half_sack_1_player_name,
         -half_sack_2_player_id,
         -half_sack_2_player_name,
         -return_team,
         -return_yards,
         -penalty_team,
         -penalty_player_id,
         -penalty_player_name,
         -penalty_yards,
         -replay_or_challenge,
         -replay_or_challenge_result,
         -penalty_type,
         -defensive_two_point_attempt,
         -defensive_two_point_conv,
         -defensive_extra_point_attempt,
         -defensive_extra_point_conv,
         -safety_player_id,
         -safety_player_name,
         -cp,
         -cpoe,
         -series_success,
         -series_result,
         -order_sequence,
         -start_time,
         -time_of_day,
         -nfl_api_id,
         -play_deleted,
         -play_type_nfl,
         -special_teams_play,
         -st_play_type,
         -end_clock_time,
         -end_yard_line,
         -fixed_drive,
         -fixed_drive_result,
         -drive_real_start_time,
         -drive_play_count,
         -drive_time_of_possession,
         -drive_time_of_possession,
         -drive_inside20,
         -drive_ended_with_score,
         -drive_quarter_start,
         -drive_quarter_end,
         -drive_yards_penalized,
         -drive_start_transition,
         -drive_end_transition,
         -drive_game_clock_start,
         -drive_game_clock_end,
         -drive_start_yard_line,
         -drive_end_yard_line,
         -drive_play_id_started,
         -drive_play_id_ended,
         -away_score,
         -home_score,
         -location,
         -result,
         -total,
         -spread_line,
         -total_line,
         -stadium_id,
         -aborted_play,
         -success,
         -passer,
         -passer_jersey_number,
         -rusher,
         -rusher_jersey_number,
         -receiver,
         -receiver_jersey_number,
         -pass,
         -rush,
         -first_down,
         -special,
         -play,
         -passer_id,
         -rusher_id,
         -receiver_id,
         -name,
         -jersey_number,
         -id,
         -fantasy_player_name,
         -fantasy_player_id,
         -fantasy,
         -fantasy_id,
         -out_of_bounds,
         -home_opening_kickoff,
         -qb_epa,
         -xyac_mean_yardage,
         -xyac_epa,
         -xyac_median_yardage,
         -xyac_success,
         -xyac_fd,
         -xpass,
         -pass_oe)

pbp
```

```{r}
##Mutate Game half into either 1 or 2 
pbp = pbp%>%
  mutate(game_half = ifelse(game_half == "Half1", 1, 2))

pbp
```


Create a unilateral "result" variable. Right now there are two vars (field goal result and xp result.)

```{r}
pbp = pbp%>%
  mutate(result = ifelse(field_goal_result == "made" | extra_point_result == "good", 1, 0))

pbp
```







